<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title lang="en">Nexenta - NexentaStor 5.x</title>
    <meta name="description" content="Nexenta">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="author" content="">
    <link href="/all.css?a" rel="stylesheet">
    <link href="/resources/images/favicon.ico" rel="shortcut icon">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" rel="stylesheet"/>
</head>
<body>


<header>
    <section class="container-docs">
        
<section class="title">
    <a href="https://nexenta.com" title="nexenta.com">
        <img src="/resources/images/logo-nexenta-with-title.png"/>
    </a>
    
</section>
<section class="container-search">
  <input id="search"/>
</section>

    </section>
</header>


<section class="content">
    
<section class="docs">
    <section class="container-docs">
        <nav><ul><li><p class="root-category">Cinder</p><ul><li><a href=/openstack/docs/cinder/overview.html><p>Overview</p></a></li><li><a href=/openstack/docs/cinder/nexentastor-5.x.html><p>NexentaStor 5.x</p></a></li><li><a href=/openstack/docs/cinder/nexentastor-4.x.html><p>NexentaStor 4.x</p></a></li><li><a href=/openstack/docs/cinder/nexentaedge-2.x.html><p>NexentaEdge 2.x</p></a></li><li><a href=/openstack/docs/cinder/iscsi-multipath.html><p>iSCSI Multipath</p></a></li><li><a href=/openstack/docs/cinder/cinder-backup.html><p>Cinder Backup</p></a></li><li><a href=/openstack/docs/cinder/multiple-nodes.html><p>Multiple Cinder Nodes</p></a></li><li><a href=/openstack/docs/cinder/issues.html><p>Known Issues</p></a></li></ul></li><li><p class="root-category">Manila</p><ul><li><a href=/openstack/docs/manila/nexentastor-5.x.html class="active"><p>NexentaStor 5.x</p></a></li><li><a href=/openstack/docs/manila/overview.html><p>Overview</p></a></li><li><a href=/openstack/docs/manila/nexentastor-4.x.html><p>NexentaStor 4.x</p></a></li></ul></li><li><p class="root-category">Other</p><ul><li><a href=/openstack/docs/other/escalating-issue-to-support.html><p>Troubleshooting and Support Request</p></a></li><li><a href=/openstack/docs/other/glance.html><p>Glance</p></a></li><li><a href=/openstack/docs/other/hpr-and-openstack.html><p>HPR and OpenStack</p></a></li><li><a href=/openstack/docs/other/upgrading-4.x-to-5.x.html><p>Upgrading 4.x to 5.x</p></a></li></ul></li></ul></nav>
        <article itemscope itemtype="http://schema.org/Article">
            <h1 itemprop="name">NexentaStor 5.x</h1>
            <h2>Overview</h2>
<p>Manila provides file services for applications running on top of OpenStack. NexentaStor Manila driver allows Manila to provision NFS shares over REST API to be consumed by applications.</p>
<h3>Supported operations are (currently only NFS is supported)</h3>
<ul>
<li>Create share</li>
<li>Delete share</li>
<li>Extend share</li>
<li>Shrink share</li>
<li>Allow share access (Only IP access type is supported - RW/RO)</li>
<li>Deny share access</li>
<li>Create snapshot</li>
<li>Delete snapshot</li>
<li>Create share from snapshot</li>
<li>Share creation options - Thin/thick provisioning, compression</li>
</ul>
<h2>Installation</h2>
<h3>Pre-requisites</h3>
<ul>
<li>NexentaStor 5.x Appliance pre-provisioned and licensed</li>
<li>Pool and parent filesystem configured (this filesystem will contain all manila shares)</li>
<li>Manila service provisioned</li>
</ul>
<h3>Download Driver</h3>
<p>It’s recommended to get the latest driver from Nexenta’s repository: <a href="https://github.com/Nexenta/manila">https://github.com/Nexenta/manila</a></p>
<p>The branches in the repository correspond with Openstack releases.</p>
<p>To following command can be used to download the exact version w/o having to switch branches</p>
<p><code>git clone -b stable/pike</code>  - this will download the exact version, no need to switch</p>
<p>Nexenta Drivers are located under the following path: <a href="https://github.com/Nexenta/manila/tree/stable/pike/manila/share/drivers/nexenta">https://github.com/Nexenta/manila/tree/stable/pike/manila/share/drivers/nexenta</a></p>
<p>The path includes drivers for NexentaStor 4.x and NexentaStor 5.x Make sure to copy the whole folder.</p>
<h3>Installation Steps</h3>
<ol>
<li>Determine manila driver location path used in your environment</li>
<li>Clone or download the correct version of the drivers, unzip if downloaded and copy to the cinder location. For example drivers for Pike release:
<pre><code>$ git clone -b stable/pike <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/github.com/</span>Nexenta/manila nexenta-manila
$ cp -rf nexenta-manila/manila/share/drivers/nexenta /usr/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">python2</span>.7/<span class="hljs-title">dist</span>-<span class="hljs-title">packages</span>/<span class="hljs-title">manila</span>/<span class="hljs-title">share</span>/<span class="hljs-title">drivers</span></span>
</code></pre></li>
<li>Configure manila.conf</li>
<li>Restart Manila Service
<ul>
<li>Systemd based system:
<code>$ sudo systemctl restart openstack-manila-share.service</code></li>
<li>Upstart/SysV based system:
<code>$ sudo service manila-share restart</code></li>
</ul></li>
</ol>
<p>manila.conf driver section examples:</p>
<pre><code>
<span class="hljs-symbol">NStor5:</span>
</code></pre>
<p>[DEFAULT]
enabled_share_backends = ns5_nfs
enabled_share_protocols = NFS</p>
<p>[ns5_nfs]
service_instance_user = manila
service_image_name = manila-service-image
path_to_private_key = /home/ubuntu/.ssh/id_rsa
path_to_public_key = /home/ubuntu/.ssh/id_rsa.pub
share_backend_name = <backend name to be used in share_types>
driver_handles_share_servers = False
share_driver = manila.share.drivers.nexenta.nexenta_nas.NexentaNasDriver
nexenta_host = <Nexenta appliance IP>
nexenta_rest_port = 8443
nexenta_volume = <pool name on appliance>
nexenta_share = <dataset name within the pool>
nexenta_user = <NexentaStor username>
nexenta_password = <NexentaStor password>
nexenta_thin_provisioning = False/True</p>
<pre><code>
List of all available options:

|<span class="hljs-string">Parameter name</span>|<span class="hljs-string">Default</span>|<span class="hljs-string">Choices</span>|<span class="hljs-string">Description</span>|
|<span class="hljs-string">--- </span>|<span class="hljs-string">--- </span>|<span class="hljs-string">--- </span>|<span class="hljs-string">--- </span>|
|<span class="hljs-string">nexenta_host</span>|||<span class="hljs-string">IP address of Nexenta storage appliance.</span>|
|<span class="hljs-string">nexenta_rest_port</span>|<span class="hljs-string">8457</span>||<span class="hljs-string">Port to connect to Nexenta REST API server.</span>|
|<span class="hljs-string">nexenta_retry_count</span>|<span class="hljs-string">6</span>||<span class="hljs-string">Number of retries for unsuccessful API calls.</span>|
|<span class="hljs-string">nexenta_rest_protocol</span>|<span class="hljs-string">auto</span>|<span class="hljs-string">[http, https, auto]</span>|<span class="hljs-string">Use http or https for REST connection .</span>|
|<span class="hljs-string">nexenta_user</span>|<span class="hljs-string">admin</span>||<span class="hljs-string">User name to connect to Nexenta SA.</span>|
|<span class="hljs-string">nexenta_password</span>|||<span class="hljs-string">Password to connect to Nexenta SA.</span>|
|<span class="hljs-string">nexenta_volume</span>|<span class="hljs-string">volume1</span>||<span class="hljs-string">Volume name on NexentaStor4</span>|
|<span class="hljs-string">nexenta_pool</span>|<span class="hljs-string">pool1</span>||<span class="hljs-string">Pool name on NexentaStor5.</span>|
|<span class="hljs-string">nexenta_mount_point_base</span>|<span class="hljs-string">$state_path/mnt</span>||<span class="hljs-string">Base directory that contains NFS share mount points.</span>|
|<span class="hljs-string">nexenta_nfs_share</span>|<span class="hljs-string">nfs_share</span>||<span class="hljs-string">Parent folder on NexentaStor that will contain all manila folders.</span>|
|<span class="hljs-string">nexenta_dataset_compression</span>|<span class="hljs-string">on</span>|<span class="hljs-string">[on, off, gzip, gzip-1, gzip-2, gzip-3,  gzip-4, gzip-5, gzip-6, gzip-7, gzip-8,gzip-9, lzjb, zle, lz4]</span>|<span class="hljs-string">Compression value for new ZFS folders.</span>|
|<span class="hljs-string">nexenta_dataset_dedupe</span>|<span class="hljs-string">off</span>|<span class="hljs-string">[on, off, sha256, verify]</span>|<span class="hljs-string">Deduplication value for new ZFS folders.</span>|
|<span class="hljs-string">nexenta_thin_provisioning</span>|<span class="hljs-string">True</span>|<span class="hljs-string">Boolean</span>|<span class="hljs-string">If True shares will not be space guaranteed and overprovisioning will be enabled.'</span>|</code></pre>

        </article>
    </section>
</section>

</section>


<footer>
    <section class="container-normal container-flex">
        <nav></nav>
        <section>
            &copy;
            <time><script>document.write(new Date().getFullYear())</script></time>
            Nexenta Systems, Inc.
        </section>
    </section>
</footer>


<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
  apiKey: '8a7bb77f6b91c0b17df8a3fd0bcb6743',
  indexName: 'nexenta',
  inputSelector: '#search',
  debug: false // Set debug to true if you want to inspect the dropdown
});
</script>

</body>
<script>
  if (window.location.hostname !== 'localhost') {
    (function (i, s, o, g, r, a, m) {i['GoogleAnalyticsObject'] = r;i[r] = i[r] || function () {
      (i[r].q = i[r].q || []).push(arguments)}, i[r].l = 1 * new Date();a = s.createElement(o),
      m = s.getElementsByTagName(o)[0];a.async = 1;a.src = g;m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', '', 'nexenta.github.io');
    ga('send', 'pageview');
  }
</script>
</html>
